<!DOCTYPE html>
<html>
<head>
    <title>justchat.com - Chat</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="messages"></div>

<div id="bottom-bar">
    <input id="msg" type="text" placeholder="[ Type a message here... ]" autocomplete="off" />
    <span id="cooldown">[ Cooldown: 0ms ]</span>
    <span id="name">[ Nickname: Test Account ]</span>
</div>

<script>
    // Room from URL
    const room = new URLSearchParams(window.location.search).get("c") || "server1";

    // WebSocket backend
const ws = new WebSocket("wss://justchat-ky2bmie7-test-accounts-projects-0ec6ab06.onrender.com/" + room);

    const messages = document.getElementById("messages");
    const input = document.getElementById("msg");
    const cooldownDisplay = document.getElementById("cooldown");

    let canSend = true;
    let cooldown = 500; // 0.5s cooldown

    ws.onmessage = (event) => {
        messages.textContent += event.data + "\n";
        window.scrollTo(0, document.body.scrollHeight);
    };

    input.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && input.value.trim() !== "" && canSend) {
            ws.send(input.value);
            input.value = "";

            canSend = false;
            let left = cooldown;

            cooldownDisplay.textContent = `[ Cooldown: ${left}ms ]`;

            const tick = setInterval(() => {
                left -= 50;
                cooldownDisplay.textContent = `[ Cooldown: ${left}ms ]`;

                if (left <= 0) {
                    clearInterval(tick);
                    cooldownDisplay.textContent = `[ Cooldown: 0ms ]`;
                    canSend = true;
                }
            }, 50);
        }
    });
</script>

</body>
</html>
